import{m as L,r as c,e as b,j as r,S as R,T as P,n as q,B as $,L as B,g as I,h as A,E as D,s as M}from"./index-BsBZMgFX.js";var k={exports:{}},F=k.exports,N;function U(){return N||(N=1,(function(_,j){(function(d,u){_.exports=u()})(F,(function(){return function(d,u,f){d=d||{};var o=u.prototype,h={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function v(e,s,l,x){return o.fromToBase(e,s,l,x)}f.en.relativeTime=h,o.fromToBase=function(e,s,l,x,T){for(var t,a,n,y=l.$locale().relativeTime||h,C=d.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],z=C.length,g=0;g<z;g+=1){var i=C[g];i.d&&(t=x?f(e).diff(l,i.d,!0):l.diff(e,i.d,!0));var p=(d.rounding||Math.round)(Math.abs(t));if(n=t>0,p<=i.r||!i.r){p<=1&&g>0&&(i=C[g-1]);var S=y[i.l];T&&(p=T(""+p)),a=typeof S=="string"?S.replace("%d",p):S(p,s,i.l,n);break}}if(s)return a;var w=n?y.future:y.past;return typeof w=="function"?w(a):w.replace("%s",a)},o.to=function(e,s){return v(e,s,this,!0)},o.from=function(e,s){return v(e,s,this)};var m=function(e){return e.$u?f.utc():f()};o.toNow=function(e){return this.to(m(this),e)},o.fromNow=function(e){return this.from(m(this),e)}}}))})(k)),k.exports}var G=U();const H=L(G);I.extend(H);const{Title:J,Text:E}=P,O=()=>{const[_,j]=c.useState([]),[d,u]=c.useState(!0),[f,o]=c.useState(0),[h,v]=c.useState(1),[m,e]=c.useState(0),s=c.useCallback(async(t=h)=>{u(!0);try{const a={page:t},{data:n}=await b.get("/assets/notifications/",{params:a});j(n.results),o(n.count),e(n.results.filter(y=>!y.is_read).length)}finally{u(!1)}},[h]);c.useEffect(()=>{s()},[]);const l=async t=>{try{await b.post(`/assets/notifications/${t}/mark_read/`),j(a=>a.map(n=>n.id===t?{...n,is_read:!0}:n)),e(a=>Math.max(0,a-1)),M.success("Позначено як прочитане")}catch{M.error("Помилка при оновленні сповіщення")}},x=async()=>{try{await b.post("/assets/notifications/mark_all_read/"),j(t=>t.map(a=>({...a,is_read:!0}))),e(0),M.success("Всі сповіщення позначено як прочитані")}catch{M.error("Помилка при оновленні сповіщень")}},T=t=>{v(t),s(t)};return r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[r.jsxs(R,{size:"middle",children:[r.jsx(J,{level:4,style:{margin:0},children:"Сповіщення"}),m>0&&r.jsx(q,{count:m,style:{backgroundColor:"#1677ff"}})]}),r.jsx($,{type:"primary",onClick:x,disabled:m===0,children:"Прочитати всі"})]}),r.jsx(B,{loading:d,dataSource:_,locale:{emptyText:r.jsx(D,{description:"Немає сповіщень"})},pagination:{current:h,total:f,pageSize:25,onChange:T,showTotal:t=>`Всього: ${t}`},renderItem:t=>r.jsx(B.Item,{style:{backgroundColor:t.is_read?"transparent":"#f0f5ff",padding:"12px 16px",borderRadius:6,marginBottom:4},actions:[t.is_read?r.jsx(E,{type:"secondary",children:"Прочитано"},"read"):r.jsx($,{type:"link",onClick:()=>l(t.id),children:"Позначити прочитаним"},"mark")],children:r.jsx(B.Item.Meta,{title:r.jsxs(R,{children:[r.jsx(E,{strong:!t.is_read,children:t.title}),r.jsx(A,{children:t.notification_type_display})]}),description:r.jsxs("div",{children:[r.jsx("div",{style:{marginBottom:4},children:t.message}),r.jsx(E,{type:"secondary",style:{fontSize:12},children:I(t.created_at).fromNow()})]})})})})]})};export{O as default};
