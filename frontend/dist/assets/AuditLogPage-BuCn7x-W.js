import{r as t,e as w,j as a,T as j,S,a as f,F as _,g as k,h as I}from"./index-BsBZMgFX.js";const{Title:C}=j,T=[{value:"create",label:"Створення"},{value:"update",label:"Зміна"},{value:"delete",label:"Видалення"},{value:"receipt",label:"Оприбуткування"},{value:"disposal",label:"Вибуття"},{value:"depreciation",label:"Амортизація"},{value:"revaluation",label:"Переоцінка"},{value:"improvement",label:"Поліпшення"},{value:"inventory",label:"Інвентаризація"}],O={create:"green",update:"blue",delete:"red",receipt:"cyan",disposal:"volcano",depreciation:"purple",revaluation:"gold",improvement:"geekblue",inventory:"orange"},A=()=>{const[p,u]=t.useState([]),[g,o]=t.useState(!0),[h,y]=t.useState(0),[n,r]=t.useState(1),[s,m]=t.useState(void 0),i=t.useCallback(async(e=n,l=s)=>{o(!0);try{const d={page:e};l&&(d.action=l);const{data:c}=await w.get("/assets/audit-log/",{params:d});u(c.results),y(c.count)}finally{o(!1)}},[n,s]);t.useEffect(()=>{i()},[]);const x=e=>{m(e),r(1),i(1,e)},v=e=>{r(e),i(e)},b=[{title:"Час",dataIndex:"timestamp",key:"timestamp",width:170,render:e=>k(e).format("DD.MM.YYYY HH:mm:ss")},{title:"Користувач",dataIndex:"user_name",key:"user_name",width:160},{title:"Дія",dataIndex:"action_display",key:"action",width:150,render:(e,l)=>a.jsx(I,{color:O[l.action]||"default",children:e})},{title:"Об'єкт",dataIndex:"object_repr",key:"object_repr",ellipsis:!0},{title:"Тип",dataIndex:"content_type_name",key:"content_type_name",width:160},{title:"IP",dataIndex:"ip_address",key:"ip_address",width:140}];return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[a.jsx(C,{level:4,style:{margin:0},children:"Журнал аудиту"}),a.jsx(S,{children:a.jsx(f,{placeholder:"Фільтр за дією",allowClear:!0,style:{width:220},value:s,onChange:x,options:T})})]}),a.jsx(_,{dataSource:p,columns:b,rowKey:"id",loading:g,size:"small",pagination:{current:n,total:h,pageSize:25,onChange:v,showTotal:e=>`Всього: ${e}`},expandable:{expandedRowRender:e=>a.jsx("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-all",fontSize:13},children:JSON.stringify(e.changes,null,2)}),rowExpandable:e=>e.changes!==null&&e.changes!==void 0&&Object.keys(e.changes).length>0},scroll:{x:1e3}})]})};export{A as default};
