import{r as s,j as e,T as M,C as o,S as C,D as R,a as I,E as P,R as A,b as i,c as d,F,d as N,e as B,f as g}from"./index-CSMAVB73.js";const{Title:L}=M,{RangePicker:$}=R,z=[{value:"receipt",label:"Оприбуткування"},{value:"depreciation",label:"Амортизація"},{value:"disposal",label:"Вибуття"},{value:"revaluation",label:"Переоцінка"},{value:"improvement",label:"Поліпшення"},{value:"repair",label:"Ремонт"}],O={receipt:"green",depreciation:"blue",disposal:"red",revaluation:"purple",improvement:"orange",repair:"cyan"},U=()=>{const[j,f]=s.useState([]),[v,u]=s.useState(!0),[c,S]=s.useState(0),[p,m]=s.useState(1),[n,D]=s.useState(void 0),[a,w]=s.useState(null),[_,b]=s.useState(0),[E,T]=s.useState(0),x=async(t=p)=>{u(!0);const r={page:t};n&&(r.entry_type=n),a&&(r.date_from=a[0].format("YYYY-MM-DD"),r.date_to=a[1].format("YYYY-MM-DD"));const{data:l}=await N.get("/assets/entries/",{params:r});f(l.results),S(l.count);let y=0,Y=0;l.results.forEach(h=>{y+=Number(h.amount),h.is_posted&&(Y+=1)}),b(y),T(Y),u(!1)};s.useEffect(()=>{m(1),x(1)},[n,a]);const k=[{title:"Дата",dataIndex:"date",key:"date",width:110,render:t=>B(t).format("DD.MM.YYYY")},{title:"Тип",dataIndex:"entry_type_display",key:"type",width:200,ellipsis:!0,render:(t,r)=>e.jsx(g,{color:O[r.entry_type]||"default",children:t})},{title:"Дебет",dataIndex:"debit_account",key:"debit",width:100},{title:"Кредит",dataIndex:"credit_account",key:"credit",width:100},{title:"Сума, грн",dataIndex:"amount",key:"amount",width:130,render:t=>Number(t).toLocaleString("uk-UA",{minimumFractionDigits:2})},{title:"ОЗ",dataIndex:"asset_name",key:"asset",ellipsis:!0},{title:"Опис",dataIndex:"description",key:"description",ellipsis:!0},{title:"Статус",dataIndex:"is_posted",key:"status",width:110,render:t=>e.jsx(g,{color:t?"green":"red",children:t?"Проведено":"Не проведено"})}];return e.jsxs("div",{children:[e.jsx(L,{level:4,children:"Журнал проводок"}),e.jsx(o,{style:{marginBottom:16},children:e.jsxs(C,{wrap:!0,children:[e.jsx($,{format:"DD.MM.YYYY",value:a,onChange:t=>{w(t)},allowClear:!0}),e.jsx(I,{placeholder:"Тип операції",options:z,value:n,onChange:t=>D(t),allowClear:!0,style:{width:200}}),e.jsx(P,{url:`/documents/entries-report/?date_from=${a?a[0].format("YYYY-MM-DD"):""}&date_to=${a?a[1].format("YYYY-MM-DD"):""}`,baseFilename:"journal-provodok",label:"Завантажити"})]})}),e.jsxs(A,{gutter:16,style:{marginBottom:16},children:[e.jsx(i,{span:8,children:e.jsx(o,{children:e.jsx(d,{title:"Всього проводок",value:c})})}),e.jsx(i,{span:8,children:e.jsx(o,{children:e.jsx(d,{title:"Загальна сума",value:_,precision:2,suffix:"грн"})})}),e.jsx(i,{span:8,children:e.jsx(o,{children:e.jsx(d,{title:"Проведено",value:E,valueStyle:{color:"#3f8600"}})})})]}),e.jsx(F,{dataSource:j,columns:k,rowKey:"id",loading:v,pagination:{current:p,total:c,pageSize:25,onChange:t=>{m(t),x(t)},showTotal:t=>`Всього: ${t}`},size:"small"})]})};export{U as default};
