import{r as s,j as t,T as M,C as r,S as P,D as R,a as I,B as A,R as B,b as F,c as i,d,F as N,e as L,f as $,g as z,h as f}from"./index-BsBZMgFX.js";const{Title:O}=M,{RangePicker:K}=R,U=[{value:"receipt",label:"Оприбуткування"},{value:"depreciation",label:"Амортизація"},{value:"disposal",label:"Вибуття"},{value:"revaluation",label:"Переоцінка"},{value:"improvement",label:"Поліпшення"},{value:"repair",label:"Ремонт"}],q={receipt:"green",depreciation:"blue",disposal:"red",revaluation:"purple",improvement:"orange",repair:"cyan"},H=()=>{const[g,j]=s.useState([]),[v,c]=s.useState(!0),[u,D]=s.useState(0),[p,m]=s.useState(1),[o,S]=s.useState(void 0),[a,w]=s.useState(null),[_,T]=s.useState(0),[b,k]=s.useState(0),x=async(e=p)=>{c(!0);const n={page:e};o&&(n.entry_type=o),a&&(n.date_from=a[0].format("YYYY-MM-DD"),n.date_to=a[1].format("YYYY-MM-DD"));const{data:l}=await L.get("/assets/entries/",{params:n});j(l.results),D(l.count);let h=0,y=0;l.results.forEach(Y=>{h+=Number(Y.amount),Y.is_posted&&(y+=1)}),T(h),k(y),c(!1)};s.useEffect(()=>{m(1),x(1)},[o,a]);const C=()=>{const e=a?a[0].format("YYYY-MM-DD"):"",n=a?a[1].format("YYYY-MM-DD"):"";$(`/documents/entries-report/?date_from=${e}&date_to=${n}`,"journal-provodok.pdf")},E=[{title:"Дата",dataIndex:"date",key:"date",width:110,render:e=>z(e).format("DD.MM.YYYY")},{title:"Тип",dataIndex:"entry_type_display",key:"type",width:150,render:(e,n)=>t.jsx(f,{color:q[n.entry_type]||"default",children:e})},{title:"Дебет",dataIndex:"debit_account",key:"debit",width:100},{title:"Кредит",dataIndex:"credit_account",key:"credit",width:100},{title:"Сума, грн",dataIndex:"amount",key:"amount",width:130,render:e=>Number(e).toLocaleString("uk-UA",{minimumFractionDigits:2})},{title:"ОЗ",dataIndex:"asset_name",key:"asset",ellipsis:!0},{title:"Опис",dataIndex:"description",key:"description",ellipsis:!0},{title:"Статус",dataIndex:"is_posted",key:"status",width:110,render:e=>t.jsx(f,{color:e?"green":"red",children:e?"Проведено":"Не проведено"})}];return t.jsxs("div",{children:[t.jsx(O,{level:4,children:"Журнал проводок"}),t.jsx(r,{style:{marginBottom:16},children:t.jsxs(P,{wrap:!0,children:[t.jsx(K,{format:"DD.MM.YYYY",value:a,onChange:e=>{w(e)},allowClear:!0}),t.jsx(I,{placeholder:"Тип операції",options:U,value:o,onChange:e=>S(e),allowClear:!0,style:{width:200}}),t.jsx(A,{icon:t.jsx(B,{}),onClick:C,children:"Завантажити PDF"})]})}),t.jsxs(F,{gutter:16,style:{marginBottom:16},children:[t.jsx(i,{span:8,children:t.jsx(r,{children:t.jsx(d,{title:"Всього проводок",value:u})})}),t.jsx(i,{span:8,children:t.jsx(r,{children:t.jsx(d,{title:"Загальна сума",value:_,precision:2,suffix:"грн"})})}),t.jsx(i,{span:8,children:t.jsx(r,{children:t.jsx(d,{title:"Проведено",value:b,valueStyle:{color:"#3f8600"}})})})]}),t.jsx(N,{dataSource:g,columns:E,rowKey:"id",loading:v,pagination:{current:p,total:u,pageSize:25,onChange:e=>{m(e),x(e)},showTotal:e=>`Всього: ${e}`},size:"small"})]})};export{H as default};
